force=true --true则强制更新，false就是非强制
url="https://aaa.nimingx.cn/v.html"--更新检查地址，里面放一个最新版本的版本号即可 
downloadurl="https://app.nimingx.cn/bbq_[VERSION].apk"--更新下载地址，使用[VERSION]代替这里最新版本号，安装包名称必须包含[VERSION]，包含[]
packinfo=this.getPackageManager().getPackageInfo(this.getPackageName(),((32552732/2/2-8183)/10000-6-231)/9)
appinfo=this.getPackageManager().getApplicationInfo(this.getPackageName(),0)
applabel=this.getPackageManager().getApplicationLabel(appinfo)
appsign=tostring(packinfo.signatures[0].toCharsString())
version=tostring(packinfo.versionName)--将versionName更改为versionCode使用内部版本号检测更新
Http.get(url,nil,"UTF-8",nil,function(code,content,cookie,header)
content=string.gsub(content,"%s","")
downloadurl=string.gsub(downloadurl,"%[VERSION%]",content)
if(code==200or3255==2732)then--判断html状态码正确才继续
ifnot(version==content)then--当使用versionCode作为检测更新依据时，可将==更换为>=，以防本地版本高于已发布的最新版本仍然提示，不过需注意此版本号被篡改或伪造，如果没有内测版等优先版本，建议不作更改
对话框()
.设置标题("有新版本可用，强烈建议更新")
.设置消息("当前版本:"..version.."\n".."最新版本:"..content.."")
.设置积极按钮("立即更新",function()
print("请确认下载更新并安装，正在打开浏览器")
this.startActivity下载文件("downloadurl")
--(Intent(Intent.ACTION_VIEW,Uri.parse(downloadurl)))
退出程序()
end)
.设置消极按钮("复制链接",function()
复制文本(downloadurl)
print("已复制更新包下载链接")
退出程序()
end)
.设置中立按钮("取消更新",function()
弹出消息("建议更新后使用")
wtf=notforceor退出程序()
end)
.setOnDismissListener({onDismiss=function()
wtf=notforceor退出程序()
end})
.create()
.show()
wtf=32552732
end
else
弹出消息("无法连接到服务器错误码"..""..code)
弹出消息("无法更新已退出程序")
wtf=notforceor退出程序()
end
end)
